(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26683,        650]
NotebookOptionsPosition[     23409,        587]
NotebookOutlinePosition[     23815,        603]
CellTagsIndexPosition[     23772,        600]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Multiway system examples", "Section",
 CellChangeTimes->{{3.8800802365533595`*^9, 3.880080274975717*^9}, {
  3.880107471889042*^9, 
  3.8801074835003147`*^9}},ExpressionUUID->"0cf9f8fd-b73e-45db-9e33-\
c8d0c667e21a"],

Cell[CellGroupData[{

Cell["Content", "Subsection",
 CellChangeTimes->{{3.8801557213241596`*^9, 3.8801557504009886`*^9}, {
  3.8801557896185455`*^9, 
  3.8801557952661934`*^9}},ExpressionUUID->"0a2f3d74-7f6b-41c8-9033-\
47fea6ceeb83"],

Cell["\<\
1. Initialization
2. First occurence
3. Unmerged count as probability
3. Rules selection
\ta) Complexity of output string (with AnglePath demonstration)
\tb) CausalInvariantQ
\
\>", "Text",
 CellChangeTimes->{{3.8801558483708677`*^9, 3.880155916838975*^9}, {
  3.8801568394683466`*^9, 3.880156945268685*^9}, {3.8801586434794807`*^9, 
  3.880158645621809*^9}, {3.8801690044417744`*^9, 3.8801690273459625`*^9}, {
  3.8803312249444804`*^9, 3.880331244820597*^9}, {3.880332327920668*^9, 
  3.88033233318154*^9}},ExpressionUUID->"f5d8d81d-42f1-4a19-9862-\
02d41ba11a86"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Section",
 CellChangeTimes->{{3.880158768065385*^9, 
  3.880158779209409*^9}},ExpressionUUID->"b43e662b-d27f-4041-af33-\
a8ae60876f04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Create", " ", "a", " ", "local", " ", "version", " ", "of", " ", 
    RowBox[{"ResourceFunction", "'"}], "s"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"causalInvariantQ", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<CausalInvariantQ\>\"", ",", "\"\<Function\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalCausalInvariantQ", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<TotalCausalInvariantQ\>\"", ",", "\"\<Function\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"multiwayEvolutionPlot", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<MultiwayEvolutionPlot\>\"", ",", "\"\<Function\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"multiwaySystem", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<MultiwaySystem\>\"", ",", "\"\<Function\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stringTuples", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<StringTuples\>\"", ",", "\"\<Function\>\""}], "]"}]}], ";", 
  RowBox[{"selectTuples", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<SelectTuples\>\"", ",", "\"\<Function\>\""}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8800897166773233`*^9, 3.8800898431603327`*^9}, {
  3.880089891495861*^9, 3.8800899094815173`*^9}, {3.8801586181221685`*^9, 
  3.8801586363855853`*^9}, {3.8801589250392838`*^9, 3.8801589420873737`*^9}, {
  3.880163183879361*^9, 3.880163185887351*^9}, {3.8802849842522545`*^9, 
  3.8802850109277844`*^9}, {3.880417138481431*^9, 3.8804171518404007`*^9}, {
  3.880426269196187*^9, 3.8804262711719055`*^9}, {3.880426315191969*^9, 
  3.880426351481841*^9}},ExpressionUUID->"80d083a0-e9c6-4766-81c9-\
f9ea6a79205f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["First occurence", "Section",
 CellChangeTimes->{{3.88010761661646*^9, 3.880107634631894*^9}, 
   3.8801085840817704`*^9},ExpressionUUID->"489079a7-0c4a-4e41-830d-\
0a81c4705658"],

Cell["\<\
 Starting from a state corresponding to a particular expression, the states \
generated by the multiway system are expressions that are ultimately \
equivalent to the original expression. The paths in the multiway system are \
then chains of transformations that represent proofs of equivalences between \
expressions\[LongDash]and the problem of whether a particular equivalence \
between expression holds is reduced to the (still potentially very difficult) \
problem of determining whether there is a path in the multiway system that \
connects the states corresponding to these expressions.
\
\>", "Text",
 CellChangeTimes->{{3.8801089232026644`*^9, 3.880108935254444*^9}, 
   3.8803313397478175`*^9},ExpressionUUID->"31a0fbb4-587d-4fb8-a8c7-\
a928f75bdf48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nMax", "=", "30"}], ";", 
   RowBox[{"(*", 
    RowBox[{"Max", " ", 
     RowBox[{"iterations", ".", " ", 
      StyleBox["SLOW",
       FontColor->RGBColor[
        0.8549019607843137, 0.5490196078431373, 0.09411764705882353]]}], 
     StyleBox[" ",
      FontColor->RGBColor[
       0.8549019607843137, 0.5490196078431373, 0.09411764705882353]], 
     StyleBox[
      RowBox[{"after", " ", "~", " ", "30"}],
      FontColor->RGBColor[
       0.8549019607843137, 0.5490196078431373, 0.09411764705882353]]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"init", "=", "\"\<A\>\""}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"goal", "=", "\"\<ABBA\>\""}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Expected", " ", "pattern"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BBB\>\""}], ",", 
     RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "0"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"NestWhile", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"++", "count"}], ";", " ", 
          RowBox[{"Last", "@", 
           RowBox[{"multiwaySystem", "[", 
            RowBox[{"rules", ",", "#", ",", "1"}], "]"}]}]}], ")"}], "&"}], 
       ",", "\[IndentingNewLine]", "init", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"#", ",", "goal"}], "]"}], "&"}], ",", "\[IndentingNewLine]",
        "1", ",", "nMax"}], "]"}]}], "\[IndentingNewLine]", ",", "count"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"count", "\[Equal]", "nMax"}], ",", "\"\<No results\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"count", ",", 
     RowBox[{"result", "/.", 
      RowBox[{"goal", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{"goal", ",", "Red", ",", "Bold"}], "]"}]}]}]}], "}"}]}], 
  "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.880083396629854*^9, 3.8800835417853165`*^9}, {
   3.8800835828942165`*^9, 3.8800836137618465`*^9}, 3.880085299427295*^9, {
   3.880085350758735*^9, 3.880085380021446*^9}, {3.880085422789398*^9, 
   3.8800854380781436`*^9}, {3.8800855229244833`*^9, 3.880085529996144*^9}, 
   3.880085574704605*^9, {3.8800862233003616`*^9, 3.880086274660325*^9}, {
   3.88008632477223*^9, 3.8800863252522717`*^9}, 3.880086402759124*^9, {
   3.8800865486133404`*^9, 3.88008660966718*^9}, {3.880086731548837*^9, 
   3.8800867633127413`*^9}, {3.880107804012476*^9, 3.8801078701605463`*^9}, {
   3.8801079727755165`*^9, 3.8801079991459627`*^9}, {3.8801080653557396`*^9, 
   3.880108079162665*^9}, {3.8801081131202297`*^9, 3.88010811721951*^9}, {
   3.880108187004239*^9, 3.880108191757462*^9}, 3.880108224264537*^9, {
   3.880108487322059*^9, 3.8801085034608297`*^9}, 3.8801086161702127`*^9, {
   3.8801086701163297`*^9, 3.880108687584306*^9}, {3.8801087764636354`*^9, 
   3.8801088349626894`*^9}, {3.880331390440011*^9, 3.880331391263811*^9}, 
   3.8804264666437807`*^9, {3.880426499588987*^9, 3.8804265072941866`*^9}, {
   3.880426545459925*^9, 3.8804265510917645`*^9}, {3.880426646129319*^9, 
   3.8804268202919445`*^9}, {3.8804268604253254`*^9, 3.88042690203272*^9}, {
   3.880426939216794*^9, 3.8804269432142344`*^9}, {3.8804270078184023`*^9, 
   3.8804271255574255`*^9}, {3.8804272245037766`*^9, 
   3.8804272297191925`*^9}, {3.8804274942744484`*^9, 3.880427838771591*^9}, {
   3.880427870848681*^9, 3.8804278797357693`*^9}, 3.880428866554854*^9},
 CellLabel->
  "In[172]:=",ExpressionUUID->"0a1f761f-d887-47ca-9cc9-e8d496a9d445"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"multiwaySystem", "[", 
      RowBox[{
      "rules", ",", "init", ",", "count", ",", "\"\<StatesGraph\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"path", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[DirectedEdge]", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "&"}], "/@", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"FindShortestPath", "[", 
         RowBox[{"g", ",", "init", ",", "goal"}], "]"}], ",", "2", ",", "1"}],
        "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"HighlightGraph", "[", 
    RowBox[{"g", ",", "path"}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.880331541167107*^9, 3.880331541615627*^9}, {
   3.8804279644506483`*^9, 3.880427987153815*^9}, {3.880428100871967*^9, 
   3.880428110761504*^9}, 3.880428773746179*^9, {3.880428845074021*^9, 
   3.880428933478895*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"a94a9448-330d-4ae4-bd86-de41f613d403"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unmerged states as probability", "Section",
 CellChangeTimes->{{3.8803316754866576`*^9, 
  3.880331699298425*^9}},ExpressionUUID->"a3fbc1c4-f795-46a1-94b2-\
323517934d97"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"multiwaySystem", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BBB\>\""}], ",", 
      RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}], ",", 
    "\"\<A\>\"", ",", "7", ",", "\"\<StatesGraphStructure\>\"", ",", 
    RowBox[{"\"\<IncludeStateWeights\>\"", "\[Rule]", "True"}], ",", 
    RowBox[{"VertexLabels", "\[Rule]", "\"\<VertexWeight\>\""}], ",", 
    RowBox[{"VertexLabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Bold", ",", "12"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.880331701505282*^9, 3.8803317020912013`*^9}, {
   3.880331732137944*^9, 3.8803317791382427`*^9}, 3.880331992404045*^9, 
   3.8804191582659063`*^9, 3.8804192294784327`*^9, {3.8804193099843664`*^9, 
   3.880419374877334*^9}, {3.8804194057988777`*^9, 3.8804194256041203`*^9}, {
   3.880419461724205*^9, 3.880419463698786*^9}, {3.880419538309174*^9, 
   3.8804195422361794`*^9}, {3.880419704877408*^9, 3.8804197139347973`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"680fcf3e-0f02-44ed-8ec8-8bbb3b16141a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rules selection", "Section",
 CellChangeTimes->{{3.8800877849329925`*^9, 3.880087801216324*^9}, {
  3.8803323453998775`*^9, 
  3.880332350359995*^9}},ExpressionUUID->"039cf0c1-710f-4d8b-ae7f-\
de8b4e4d7253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Generate", " ", "all", " ", "rules", " ", "in", " ", "form", " ", 
       SubscriptBox["L", "1"], 
       SubscriptBox["L", "2"]}], "..."}], 
     SubscriptBox["L", "len1"]}], " ", "\[Rule]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["L", "1"], 
       SubscriptBox["L", "2"]}], "..."}], 
     SubscriptBox["L", "len2"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rulesSet", "[", 
     RowBox[{"len1_", ",", "len2_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "\[Rule]", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], "/@", 
     RowBox[{"selectTuples", "[", 
      RowBox[{
       RowBox[{"stringTuples", "[", 
        RowBox[{"\"\<AB\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"len1", ",", "len2"}], "]"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "<=",
           "len1"}], "&&", 
         RowBox[{
          RowBox[{"StringLength", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "<=",
           "len2"}]}], "&"}]}], "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8801118724403934`*^9, 3.880111962734923*^9}, {
  3.880158685284614*^9, 3.880158702320675*^9}, {3.8803324419475784`*^9, 
  3.8803325127074366`*^9}, {3.8803382121519766`*^9, 3.880338215996191*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"51f47a97-3e9a-4601-bf9f-a72c5f4e4569"],

Cell[CellGroupData[{

Cell["Selection by causal invariance ", "Subsection",
 CellChangeTimes->{{3.880158831451502*^9, 3.8801588634033346`*^9}, 
   3.8801590167358527`*^9},ExpressionUUID->"0b1c75bb-719f-4a62-af47-\
6de5fef74574"],

Cell[BoxData[
 RowBox[{"set1", "=", 
  RowBox[{"rulesSet", "[", 
   RowBox[{"1", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8800879768427*^9, 3.8800879825301886`*^9}, {
   3.8800881595158997`*^9, 3.8800881702987566`*^9}, {3.8800882071297045`*^9, 
   3.880088229121929*^9}, {3.88008826392206*^9, 3.880088342153713*^9}, {
   3.8800883889221745`*^9, 3.880088406252554*^9}, {3.8800891020622663`*^9, 
   3.8800891211582637`*^9}, {3.880089151354842*^9, 3.880089162248107*^9}, {
   3.8800899369653044`*^9, 3.8800899555428348`*^9}, {3.880089990329588*^9, 
   3.880090015328043*^9}, {3.880090050681386*^9, 3.880090058183149*^9}, {
   3.88009014473249*^9, 3.8800902097667007`*^9}, 3.8800903119352846`*^9, {
   3.880090358342826*^9, 3.880090435839156*^9}, {3.8800904844618287`*^9, 
   3.8800904871992054`*^9}, {3.880090553111094*^9, 3.8800905746865735`*^9}, {
   3.880090635646783*^9, 3.8800907440593805`*^9}, {3.8800909345286636`*^9, 
   3.8800909610565042`*^9}, 3.8800915471944695`*^9, 3.880091656221505*^9, 
   3.880091872426674*^9, 3.8800919281948075`*^9, 3.8800919790804167`*^9, 
   3.880092044781573*^9, 3.880092196433668*^9, 3.88009238306877*^9, {
   3.8800924853324847`*^9, 3.880092508468642*^9}, {3.8800926097578154`*^9, 
   3.8800926207806263`*^9}, {3.8800928695859118`*^9, 3.8800928714525967`*^9}, 
   3.8800931486644783`*^9, {3.8801119775931664`*^9, 3.880111984054052*^9}, 
   3.880112444810091*^9, {3.880112558224472*^9, 3.8801125778798685`*^9}, 
   3.880115788787025*^9, 3.8801158809229574`*^9, 3.8801162795754485`*^9, 
   3.880158716969395*^9, 3.8801590298510437`*^9, 3.880159244028761*^9, 
   3.880289390657135*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"51313799-4c7e-4d34-ba91-b9f1ca341754"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"set2", "=", 
   RowBox[{"rulesSet", "[", 
    RowBox[{"2", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8801590604132442`*^9, 3.880159069536569*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"6b4698f5-608c-4322-b372-c1f3bbf20811"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"result", "=", 
   RowBox[{"selectTuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"set1", ",", "set2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"totalCausalInvariantQ", "[", 
       RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8801590840784826`*^9, 3.880159145492943*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4f0c8e54-6a20-4390-a7f5-ac5b41d785a9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"multiwayEvolutionPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BBB\>\""}], ",", " ", 
      RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}], ",", 
    "\"\<A\>\"", ",", "5"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.880159160735564*^9, 3.880159201494464*^9}, {
  3.880289899933615*^9, 3.8802899043923264`*^9}, {3.880290914573185*^9, 
  3.880290950983181*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"bd4bcc2e-eaba-4afb-8fdd-0f38bd6c7df4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection by complexity", "Subsection",
 CellChangeTimes->{{3.8801587357276106`*^9, 3.8801587487809243`*^9}, {
   3.880332377705392*^9, 3.8803323812819624`*^9}, 
   3.880332581694354*^9},ExpressionUUID->"f976285d-3020-4d54-a481-\
c08135e83b67"],

Cell["\<\
Criteria:
Non-empty, non-primitive and not 1-loop output\
\>", "Text",
 CellChangeTimes->{{3.880332583527546*^9, 3.880332594870317*^9}, {
  3.8803379290293293`*^9, 3.8803379379064937`*^9}, {3.880416980444028*^9, 
  3.880417000062642*^9}, {3.8804173675473995`*^9, 
  3.880417383942583*^9}},ExpressionUUID->"c968d682-4d95-4cab-b4f0-\
8e40dde370ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"criteria", "[", "rule_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", "=", 
       RowBox[{"multiwaySystem", "[", 
        RowBox[{"rule", ",", "\"\<A\>\"", ",", "2"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
       RowBox[{"data", "\[LeftDoubleBracket]", 
        RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], "&&", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"data", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ">", "0"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8803379399142747`*^9, 3.8803379402424192`*^9}, {
   3.8803380058406086`*^9, 3.88033811792216*^9}, {3.8803383716629305`*^9, 
   3.880338372150523*^9}, {3.880417321809495*^9, 3.880417351734126*^9}, {
   3.880417409114135*^9, 3.88041751707117*^9}, {3.8804175472148848`*^9, 
   3.880417552783352*^9}, 3.880417665703879*^9, 3.880417785876477*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"3417715c-53a5-45ea-8305-27584ccef85d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"selectTuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rulesSet", "[", 
        RowBox[{"2", ",", "2"}], "]"}], ",", 
       RowBox[{"rulesSet", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"criteria", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8804178708029857`*^9, 3.8804179164281373`*^9}, {
   3.88041796776527*^9, 3.8804179721403484`*^9}, 3.880418017787111*^9, {
   3.880418061862092*^9, 3.880418066922737*^9}, 
   3.8804183157051344`*^9},ExpressionUUID->"6ea12793-87cd-43b6-bb08-\
bf9591346b90"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"multiwayEvolutionPlot", "[", 
     RowBox[{
      RowBox[{
      "result", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
      "\"\<A\>\"", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "result"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8804181890166073`*^9, 3.880418238406*^9}, 
   3.880418318512557*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"682ff5df-e87b-44d9-a478-20d3e8299c1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angle path", "Section",
 CellChangeTimes->{{3.880116194342454*^9, 3.880116216546551*^9}, 
   3.8801181785351014`*^9, {3.8801589822305117`*^9, 
   3.880158988215556*^9}},ExpressionUUID->"e09bb414-1d56-4bf1-8297-\
356563607fba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"toBin", "[", "str_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringPartition", "[", 
     RowBox[{"str", ",", "1"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "\[Rule]", "1"}], ",", 
      RowBox[{"\"\<B\>\"", "\[Rule]", 
       RowBox[{"-", "1"}]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showPath", "[", 
    RowBox[{"seq_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"AnglePath", "[", 
       RowBox[{"\[Alpha]", " ", "seq"}], "]"}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"250", ",", "250"}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88015934652155*^9, 3.8801593613448915`*^9}, {
   3.880159410456372*^9, 3.8801594201675067`*^9}, {3.8801595052227736`*^9, 
   3.880159538345607*^9}, 3.880159568801242*^9, {3.88016369458477*^9, 
   3.8801636977489357`*^9}, {3.8801639924194217`*^9, 
   3.8801639934912558`*^9}, {3.880164242695409*^9, 3.8801642427957525`*^9}, {
   3.880164656210669*^9, 3.880164656912967*^9}, {3.880166183715129*^9, 
   3.8801661841164083`*^9}, {3.8804184189376497`*^9, 
   3.880418420018855*^9}},ExpressionUUID->"05af96d2-455a-4ca8-8927-\
4b2062878d06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kneadingSeqRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<AB\>\""}], ",", 
     RowBox[{"\"\<B\>\"", "\[Rule]", "\"\<AA\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySeqRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BA\>\""}], ",", 
     RowBox[{"\"\<AA\>\"", "\[Rule]", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8801595466113796`*^9, 3.880159553744955*^9}, {
  3.8801640513419776`*^9, 3.880164092315114*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"6fddaba5-f45e-4560-97f4-77cee492bde5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"showPath", "[", 
     RowBox[{
      RowBox[{"toBin", "[", "\[IndentingNewLine]", 
       RowBox[{"First", "@", 
        RowBox[{"SubstitutionSystem", "[", 
         RowBox[{"mySeqRules", ",", "\"\<A\>\"", ",", 
          RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"2", 
       RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "30", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.880118183255215*^9, 3.8801181837521124`*^9}, {
  3.8801182614664106`*^9, 3.880118278112255*^9}, {3.8801635867586355`*^9, 
  3.8801635900325527`*^9}, {3.8801636419482327`*^9, 3.8801636608872585`*^9}, {
  3.880163707825162*^9, 3.8801637618757486`*^9}, {3.8801638342230167`*^9, 
  3.8801638368320847`*^9}, {3.8801638687493234`*^9, 3.8801639203682785`*^9}, {
  3.880164032585245*^9, 3.880164033070547*^9}, {3.8801641064912167`*^9, 
  3.88016411885419*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"8d7ebd0b-66c0-47b7-b8a0-d53d58b8620d"]
}, Open  ]]
},
WindowSize->{960, 508},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c8b0c313-9512-48b7-a89f-6a5cee28e14b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 222, 4, 67, "Section",ExpressionUUID->"0cf9f8fd-b73e-45db-9e33-c8d0c667e21a"],
Cell[CellGroupData[{
Cell[827, 30, 212, 4, 54, "Subsection",ExpressionUUID->"0a2f3d74-7f6b-41c8-9033-47fea6ceeb83"],
Cell[1042, 36, 575, 14, 166, "Text",ExpressionUUID->"f5d8d81d-42f1-4a19-9862-02d41ba11a86"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1666, 56, 149, 3, 67, "Section",ExpressionUUID->"b43e662b-d27f-4041-af33-a8ae60876f04"],
Cell[1818, 61, 1921, 42, 181, "Input",ExpressionUUID->"80d083a0-e9c6-4766-81c9-f9ea6a79205f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3776, 108, 184, 3, 67, "Section",ExpressionUUID->"489079a7-0c4a-4e41-830d-0a81c4705658"],
Cell[3963, 113, 772, 13, 144, "Text",ExpressionUUID->"31a0fbb4-587d-4fb8-a8c7-a928f75bdf48"],
Cell[4738, 128, 3890, 85, 281, "Input",ExpressionUUID->"0a1f761f-d887-47ca-9cc9-e8d496a9d445"],
Cell[8631, 215, 1207, 30, 107, "Input",ExpressionUUID->"a94a9448-330d-4ae4-bd86-de41f613d403"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9875, 250, 177, 3, 67, "Section",ExpressionUUID->"a3fbc1c4-f795-46a1-94b2-323517934d97"],
Cell[10055, 255, 1143, 20, 68, "Input",ExpressionUUID->"680fcf3e-0f02-44ed-8ec8-8bbb3b16141a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11235, 280, 213, 4, 67, "Section",ExpressionUUID->"039cf0c1-710f-4d8b-ae7f-de8b4e4d7253"],
Cell[11451, 286, 1934, 53, 103, "Input",ExpressionUUID->"51f47a97-3e9a-4601-bf9f-a72c5f4e4569",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[13410, 343, 206, 3, 54, "Subsection",ExpressionUUID->"0b1c75bb-719f-4a62-af47-6de5fef74574"],
Cell[13619, 348, 1709, 25, 28, "Input",ExpressionUUID->"51313799-4c7e-4d34-ba91-b9f1ca341754"],
Cell[15331, 375, 296, 6, 48, "Input",ExpressionUUID->"6b4698f5-608c-4322-b372-c1f3bbf20811"],
Cell[15630, 383, 462, 11, 48, "Input",ExpressionUUID->"4f0c8e54-6a20-4390-a7f5-ac5b41d785a9"],
Cell[16095, 396, 559, 12, 48, "Input",ExpressionUUID->"bd4bcc2e-eaba-4afb-8fdd-0f38bd6c7df4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16691, 413, 250, 4, 54, "Subsection",ExpressionUUID->"f976285d-3020-4d54-a481-c08135e83b67"],
Cell[16944, 419, 356, 8, 56, "Text",ExpressionUUID->"c968d682-4d95-4cab-b4f0-8e40dde370ad"],
Cell[17303, 429, 1244, 28, 64, "Input",ExpressionUUID->"3417715c-53a5-45ea-8305-27584ccef85d",
 InitializationCell->True],
Cell[18550, 459, 666, 17, 28, "Input",ExpressionUUID->"6ea12793-87cd-43b6-bb08-bf9591346b90"],
Cell[19219, 478, 612, 15, 68, "Input",ExpressionUUID->"682ff5df-e87b-44d9-a478-20d3e8299c1c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19880, 499, 232, 4, 67, "Section",ExpressionUUID->"e09bb414-1d56-4bf1-8297-356563607fba"],
Cell[20115, 505, 1355, 33, 64, "Input",ExpressionUUID->"05af96d2-455a-4ca8-8927-4b2062878d06",
 InitializationCell->True],
Cell[21473, 540, 745, 19, 64, "Input",ExpressionUUID->"6fddaba5-f45e-4560-97f4-77cee492bde5",
 InitializationCell->True],
Cell[22221, 561, 1172, 23, 126, "Input",ExpressionUUID->"8d7ebd0b-66c0-47b7-b8a0-d53d58b8620d"]
}, Open  ]]
}
]
*)


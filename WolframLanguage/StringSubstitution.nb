(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30372,        745]
NotebookOptionsPosition[     26814,        679]
NotebookOutlinePosition[     27217,        695]
CellTagsIndexPosition[     27174,        692]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Multiway system examples", "Section",
 CellChangeTimes->{{3.8800802365533595`*^9, 3.880080274975717*^9}, {
  3.880107471889042*^9, 
  3.8801074835003147`*^9}},ExpressionUUID->"0cf9f8fd-b73e-45db-9e33-\
c8d0c667e21a"],

Cell[CellGroupData[{

Cell["Content", "Subsection",
 CellChangeTimes->{{3.8801557213241596`*^9, 3.8801557504009886`*^9}, {
  3.8801557896185455`*^9, 
  3.8801557952661934`*^9}},ExpressionUUID->"0a2f3d74-7f6b-41c8-9033-\
47fea6ceeb83"],

Cell["\<\
1. Initialization
2. First occurence
3. Unmerged count as probability
3. Rules selection
\ta) Complexity of output string (with AnglePath demonstration)
\tb) CausalInvariantQ
\
\>", "Text",
 CellChangeTimes->{{3.8801558483708677`*^9, 3.880155916838975*^9}, {
  3.8801568394683466`*^9, 3.880156945268685*^9}, {3.8801586434794807`*^9, 
  3.880158645621809*^9}, {3.8801690044417744`*^9, 3.8801690273459625`*^9}, {
  3.8803312249444804`*^9, 3.880331244820597*^9}, {3.880332327920668*^9, 
  3.88033233318154*^9}},ExpressionUUID->"f5d8d81d-42f1-4a19-9862-\
02d41ba11a86"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Section",
 CellChangeTimes->{{3.880158768065385*^9, 
  3.880158779209409*^9}},ExpressionUUID->"b43e662b-d27f-4041-af33-\
a8ae60876f04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Create", " ", "a", " ", "local", " ", "version", " ", "of", " ", 
    RowBox[{"ResourceFunction", "'"}], "s"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"causalInvariantQ", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<CausalInvariantQ\>\"", ",", "\"\<Function\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalCausalInvariantQ", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<TotalCausalInvariantQ\>\"", ",", "\"\<Function\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"multiwayEvolutionPlot", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<MultiwayEvolutionPlot\>\"", ",", "\"\<Function\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"multiwaySystem", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<MultiwaySystem\>\"", ",", "\"\<Function\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stringTuples", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<StringTuples\>\"", ",", "\"\<Function\>\""}], "]"}]}], ";", 
  RowBox[{"selectTuples", "=", 
   RowBox[{"ResourceFunction", "[", 
    RowBox[{"\"\<SelectTuples\>\"", ",", "\"\<Function\>\""}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8800897166773233`*^9, 3.8800898431603327`*^9}, {
  3.880089891495861*^9, 3.8800899094815173`*^9}, {3.8801586181221685`*^9, 
  3.8801586363855853`*^9}, {3.8801589250392838`*^9, 3.8801589420873737`*^9}, {
  3.880163183879361*^9, 3.880163185887351*^9}, {3.8802849842522545`*^9, 
  3.8802850109277844`*^9}, {3.880417138481431*^9, 3.8804171518404007`*^9}, {
  3.880426269196187*^9, 3.8804262711719055`*^9}, {3.880426315191969*^9, 
  3.880426351481841*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"80d083a0-e9c6-4766-81c9-f9ea6a79205f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["First occurence", "Section",
 CellChangeTimes->{{3.88010761661646*^9, 3.880107634631894*^9}, 
   3.8801085840817704`*^9},ExpressionUUID->"489079a7-0c4a-4e41-830d-\
0a81c4705658"],

Cell["\<\
 Starting from a state corresponding to a particular expression, the states \
generated by the multiway system are expressions that are ultimately \
equivalent to the original expression. The paths in the multiway system are \
then chains of transformations that represent proofs of equivalences between \
expressions\[LongDash]and the problem of whether a particular equivalence \
between expression holds is reduced to the (still potentially very difficult) \
problem of determining whether there is a path in the multiway system that \
connects the states corresponding to these expressions.
\
\>", "Text",
 CellChangeTimes->{{3.8801089232026644`*^9, 3.880108935254444*^9}, 
   3.8803313397478175`*^9},ExpressionUUID->"31a0fbb4-587d-4fb8-a8c7-\
a928f75bdf48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nMax", "=", "30"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Max", " ", 
    RowBox[{"iterations", ".", " ", 
     StyleBox["SLOW",
      FontColor->RGBColor[
       0.8549019607843137, 0.5490196078431373, 0.09411764705882353]]}], 
    StyleBox[" ",
     FontColor->RGBColor[
      0.8549019607843137, 0.5490196078431373, 0.09411764705882353]], 
    StyleBox[
     RowBox[{"after", " ", "~", " ", "30"}],
     FontColor->RGBColor[
      0.8549019607843137, 0.5490196078431373, 0.09411764705882353]]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"init", "=", "\"\<A\>\""}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"goal", "=", "\"\<ABBA\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Expected", " ", "pattern"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BBB\>\""}], ",", 
     RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "0"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"NestWhile", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"++", "count"}], ";", " ", 
          RowBox[{"Last", "@", 
           RowBox[{"multiwaySystem", "[", 
            RowBox[{"rules", ",", "#", ",", "1"}], "]"}]}]}], ")"}], "&"}], 
       ",", "\[IndentingNewLine]", "init", ",", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"#", ",", "goal"}], "]"}], "&"}], ",", "1", ",", "nMax"}], 
      "]"}]}], "\[IndentingNewLine]", ",", "count"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"count", "\[Equal]", "nMax"}], ",", "\"\<No results\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"count", ",", 
     RowBox[{"result", "/.", 
      RowBox[{"goal", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{"goal", ",", "Red", ",", "Bold"}], "]"}]}]}]}], "}"}]}], 
  "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.880083396629854*^9, 3.8800835417853165`*^9}, {
   3.8800835828942165`*^9, 3.8800836137618465`*^9}, 3.880085299427295*^9, {
   3.880085350758735*^9, 3.880085380021446*^9}, {3.880085422789398*^9, 
   3.8800854380781436`*^9}, {3.8800855229244833`*^9, 3.880085529996144*^9}, 
   3.880085574704605*^9, {3.8800862233003616`*^9, 3.880086274660325*^9}, {
   3.88008632477223*^9, 3.8800863252522717`*^9}, 3.880086402759124*^9, {
   3.8800865486133404`*^9, 3.88008660966718*^9}, {3.880086731548837*^9, 
   3.8800867633127413`*^9}, {3.880107804012476*^9, 3.8801078701605463`*^9}, {
   3.8801079727755165`*^9, 3.8801079991459627`*^9}, {3.8801080653557396`*^9, 
   3.880108079162665*^9}, {3.8801081131202297`*^9, 3.88010811721951*^9}, {
   3.880108187004239*^9, 3.880108191757462*^9}, 3.880108224264537*^9, {
   3.880108487322059*^9, 3.8801085034608297`*^9}, 3.8801086161702127`*^9, {
   3.8801086701163297`*^9, 3.880108687584306*^9}, {3.8801087764636354`*^9, 
   3.8801088349626894`*^9}, {3.880331390440011*^9, 3.880331391263811*^9}, 
   3.8804264666437807`*^9, {3.880426499588987*^9, 3.8804265072941866`*^9}, {
   3.880426545459925*^9, 3.8804265510917645`*^9}, {3.880426646129319*^9, 
   3.8804268202919445`*^9}, {3.8804268604253254`*^9, 3.88042690203272*^9}, {
   3.880426939216794*^9, 3.8804269432142344`*^9}, {3.8804270078184023`*^9, 
   3.8804271255574255`*^9}, {3.8804272245037766`*^9, 
   3.8804272297191925`*^9}, {3.8804274942744484`*^9, 3.880427838771591*^9}, {
   3.880427870848681*^9, 3.8804278797357693`*^9}, 3.880428866554854*^9, 
   3.8804583903100157`*^9, {3.8804584587371936`*^9, 
   3.8804584606596093`*^9}},ExpressionUUID->"0a1f761f-d887-47ca-9cc9-\
e8d496a9d445"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"multiwaySystem", "[", 
      RowBox[{
      "rules", ",", "init", ",", "count", ",", "\"\<StatesGraph\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"path", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[DirectedEdge]", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
        "&"}], "/@", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"FindShortestPath", "[", 
         RowBox[{"g", ",", "init", ",", "goal"}], "]"}], ",", "2", ",", "1"}],
        "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"HighlightGraph", "[", 
    RowBox[{"g", ",", "path"}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.880331541167107*^9, 3.880331541615627*^9}, {
   3.8804279644506483`*^9, 3.880427987153815*^9}, {3.880428100871967*^9, 
   3.880428110761504*^9}, 3.880428773746179*^9, {3.880428845074021*^9, 
   3.880428933478895*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"a94a9448-330d-4ae4-bd86-de41f613d403"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unmerged states as probability", "Section",
 CellChangeTimes->{{3.8803316754866576`*^9, 
  3.880331699298425*^9}},ExpressionUUID->"a3fbc1c4-f795-46a1-94b2-\
323517934d97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"init", "=", "\"\<A\>\""}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BBB\>\""}], ",", 
      RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"multiwaySystem", "[", 
  RowBox[{
  "rules", ",", "init", ",", "num", ",", "\"\<EvolutionGraphUnmerged\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.880331701505282*^9, 3.8803317020912013`*^9}, {
   3.880331732137944*^9, 3.8803317791382427`*^9}, 3.880331992404045*^9, 
   3.8804191582659063`*^9, 3.8804192294784327`*^9, {3.8804193099843664`*^9, 
   3.880419374877334*^9}, {3.8804194057988777`*^9, 3.8804194256041203`*^9}, {
   3.880419461724205*^9, 3.880419463698786*^9}, {3.880419538309174*^9, 
   3.8804195422361794`*^9}, {3.880419704877408*^9, 3.8804197139347973`*^9}, {
   3.8804585116535916`*^9, 3.880458701912125*^9}, {3.8804587459659805`*^9, 
   3.8804587735740037`*^9}, {3.880458807976694*^9, 3.880458811170705*^9}, {
   3.8804590034113026`*^9, 3.880459084796007*^9}, {3.8804591474949856`*^9, 
   3.880459159645712*^9}, {3.8804592534038463`*^9, 3.880459316862314*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"680fcf3e-0f02-44ed-8ec8-8bbb3b16141a"],

Cell[BoxData[
 RowBox[{"multiwaySystem", "[", 
  RowBox[{"rules", ",", "init", ",", "num", ",", "\"\<StatesGraph\>\"", ",", 
   RowBox[{"\"\<IncludeStateWeights\>\"", "\[Rule]", "True"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"VertexLabels", "\[Rule]", "\"\<VertexWeight\>\""}], ",", 
   RowBox[{"VertexLabelStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Red", ",", "Bold", ",", "12"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.880331701505282*^9, 3.8803317020912013`*^9}, {
   3.880331732137944*^9, 3.8803317791382427`*^9}, 3.880331992404045*^9, 
   3.8804191582659063`*^9, 3.8804192294784327`*^9, {3.8804193099843664`*^9, 
   3.880419374877334*^9}, {3.8804194057988777`*^9, 3.8804194256041203`*^9}, {
   3.880419461724205*^9, 3.880419463698786*^9}, {3.880419538309174*^9, 
   3.8804195422361794`*^9}, {3.880419704877408*^9, 3.8804197139347973`*^9}, {
   3.8804585116535916`*^9, 3.880458701912125*^9}, {3.8804587459659805`*^9, 
   3.8804587735740037`*^9}, {3.880458807976694*^9, 3.880458811170705*^9}, {
   3.8804590034113026`*^9, 3.880459084796007*^9}, {3.8804591474949856`*^9, 
   3.880459159645712*^9}, {3.8804592534038463`*^9, 3.880459320620565*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"6cfdde91-76c9-4582-be90-3f639699ce41"],

Cell[TextData[{
 "\nLooks like ",
 ButtonBox["Alterverse",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://en.wikipedia.org/wiki/Many-worlds_interpretation"], None},
  ButtonNote->"https://en.wikipedia.org/wiki/Many-worlds_interpretation"],
 "..."
}], "Text",
 CellChangeTimes->{
  3.880459363760434*^9, {3.880460107560882*^9, 
   3.880460147553917*^9}},ExpressionUUID->"4ca806ce-ef16-407b-a60f-\
734b0678f084"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rules selection", "Section",
 CellChangeTimes->{{3.8800877849329925`*^9, 3.880087801216324*^9}, {
  3.8803323453998775`*^9, 
  3.880332350359995*^9}},ExpressionUUID->"039cf0c1-710f-4d8b-ae7f-\
de8b4e4d7253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Generate", " ", "all", " ", "rules", " ", "in", " ", "form", " ", 
       SubscriptBox["L", "1"], 
       SubscriptBox["L", "2"]}], "..."}], 
     SubscriptBox["L", "len1"]}], " ", "\[Rule]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["L", "1"], 
       SubscriptBox["L", "2"]}], "..."}], 
     SubscriptBox["L", "len2"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rulesSet", "[", 
     RowBox[{"len1_", ",", "len2_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "\[Rule]", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], "/@", 
     RowBox[{"selectTuples", "[", 
      RowBox[{
       RowBox[{"stringTuples", "[", 
        RowBox[{"\"\<AB\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"len1", ",", "len2"}], "]"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "<=",
           "len1"}], "&&", 
         RowBox[{
          RowBox[{"StringLength", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "<=",
           "len2"}]}], "&"}]}], "]"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8801118724403934`*^9, 3.880111962734923*^9}, {
  3.880158685284614*^9, 3.880158702320675*^9}, {3.8803324419475784`*^9, 
  3.8803325127074366`*^9}, {3.8803382121519766`*^9, 3.880338215996191*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"51f47a97-3e9a-4601-bf9f-a72c5f4e4569"],

Cell[CellGroupData[{

Cell["Selection by causal invariance ", "Subsection",
 CellChangeTimes->{{3.880158831451502*^9, 3.8801588634033346`*^9}, 
   3.8801590167358527`*^9},ExpressionUUID->"0b1c75bb-719f-4a62-af47-\
6de5fef74574"],

Cell[BoxData[
 RowBox[{"result", "=", 
  RowBox[{"selectTuples", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rulesSet", "[", 
       RowBox[{"1", ",", "2"}], "]"}], ",", 
      RowBox[{"rulesSet", "[", 
       RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"totalCausalInvariantQ", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8801590840784826`*^9, 3.880159145492943*^9}, {
  3.8804602147182827`*^9, 3.8804602592020063`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"4f0c8e54-6a20-4390-a7f5-ac5b41d785a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection by complexity", "Subsection",
 CellChangeTimes->{{3.8801587357276106`*^9, 3.8801587487809243`*^9}, {
   3.880332377705392*^9, 3.8803323812819624`*^9}, 
   3.880332581694354*^9},ExpressionUUID->"f976285d-3020-4d54-a481-\
c08135e83b67"],

Cell["\<\
Criteria:
Non-empty, non-primitive and not 1-loop output\
\>", "Text",
 CellChangeTimes->{{3.880332583527546*^9, 3.880332594870317*^9}, {
  3.8803379290293293`*^9, 3.8803379379064937`*^9}, {3.880416980444028*^9, 
  3.880417000062642*^9}, {3.8804173675473995`*^9, 
  3.880417383942583*^9}},ExpressionUUID->"c968d682-4d95-4cab-b4f0-\
8e40dde370ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"criteria", "[", "rule_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", "=", 
       RowBox[{"multiwaySystem", "[", 
        RowBox[{"rule", ",", "\"\<A\>\"", ",", "2"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
       RowBox[{"data", "\[LeftDoubleBracket]", 
        RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], "&&", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"data", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ">", "0"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8803379399142747`*^9, 3.8803379402424192`*^9}, {
   3.8803380058406086`*^9, 3.88033811792216*^9}, {3.8803383716629305`*^9, 
   3.880338372150523*^9}, {3.880417321809495*^9, 3.880417351734126*^9}, {
   3.880417409114135*^9, 3.88041751707117*^9}, {3.8804175472148848`*^9, 
   3.880417552783352*^9}, 3.880417665703879*^9, 3.880417785876477*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"3417715c-53a5-45ea-8305-27584ccef85d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"selectTuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rulesSet", "[", 
        RowBox[{"2", ",", "2"}], "]"}], ",", 
       RowBox[{"rulesSet", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"criteria", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8804178708029857`*^9, 3.8804179164281373`*^9}, {
   3.88041796776527*^9, 3.8804179721403484`*^9}, 3.880418017787111*^9, {
   3.880418061862092*^9, 3.880418066922737*^9}, 3.8804183157051344`*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"6ea12793-87cd-43b6-bb08-bf9591346b90"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"multiwayEvolutionPlot", "[", 
     RowBox[{
      RowBox[{
      "result", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
      "\"\<A\>\"", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "result"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8804181890166073`*^9, 3.880418238406*^9}, 
   3.880418318512557*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"682ff5df-e87b-44d9-a478-20d3e8299c1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angle path", "Section",
 CellChangeTimes->{{3.880116194342454*^9, 3.880116216546551*^9}, 
   3.8801181785351014`*^9, {3.8801589822305117`*^9, 
   3.880158988215556*^9}},ExpressionUUID->"e09bb414-1d56-4bf1-8297-\
356563607fba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"toBin", "[", "str_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringPartition", "[", 
     RowBox[{"str", ",", "1"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<A\>\"", "\[Rule]", "1"}], ",", 
      RowBox[{"\"\<B\>\"", "\[Rule]", 
       RowBox[{"-", "1"}]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showPath", "[", 
    RowBox[{"seq_", ",", "\[Alpha]_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"AnglePath", "[", 
       RowBox[{"\[Alpha]", " ", "seq"}], "]"}], "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"250", ",", "250"}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88015934652155*^9, 3.8801593613448915`*^9}, {
   3.880159410456372*^9, 3.8801594201675067`*^9}, {3.8801595052227736`*^9, 
   3.880159538345607*^9}, 3.880159568801242*^9, {3.88016369458477*^9, 
   3.8801636977489357`*^9}, {3.8801639924194217`*^9, 
   3.8801639934912558`*^9}, {3.880164242695409*^9, 3.8801642427957525`*^9}, {
   3.880164656210669*^9, 3.880164656912967*^9}, {3.880166183715129*^9, 
   3.8801661841164083`*^9}, {3.8804184189376497`*^9, 3.880418420018855*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"05af96d2-455a-4ca8-8927-4b2062878d06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kneadingSeqRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<AB\>\""}], ",", 
     RowBox[{"\"\<B\>\"", "\[Rule]", "\"\<AA\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySeqRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "\[Rule]", "\"\<BA\>\""}], ",", 
     RowBox[{"\"\<AA\>\"", "\[Rule]", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<BB\>\"", "\[Rule]", "\"\<A\>\""}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8801595466113796`*^9, 3.880159553744955*^9}, {
  3.8801640513419776`*^9, 3.880164092315114*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6fddaba5-f45e-4560-97f4-77cee492bde5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"showPath", "[", 
     RowBox[{
      RowBox[{"toBin", "@", "\[IndentingNewLine]", 
       RowBox[{"First", "@", 
        RowBox[{"SubstitutionSystem", "[", 
         RowBox[{"mySeqRules", ",", "\"\<A\>\"", ",", 
          RowBox[{"{", "n", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"2.", 
       RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "30", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.880118183255215*^9, 3.8801181837521124`*^9}, {
  3.8801182614664106`*^9, 3.880118278112255*^9}, {3.8801635867586355`*^9, 
  3.8801635900325527`*^9}, {3.8801636419482327`*^9, 3.8801636608872585`*^9}, {
  3.880163707825162*^9, 3.8801637618757486`*^9}, {3.8801638342230167`*^9, 
  3.8801638368320847`*^9}, {3.8801638687493234`*^9, 3.8801639203682785`*^9}, {
  3.880164032585245*^9, 3.880164033070547*^9}, {3.8801641064912167`*^9, 
  3.88016411885419*^9}, {3.880460705808052*^9, 
  3.880460732954194*^9}},ExpressionUUID->"8d7ebd0b-66c0-47b7-b8a0-\
d53d58b8620d"],

Cell[TextData[{
 "A very naive approach, but with significant results.\nIf the area of \
AnglePath increases, then the rule may be \[OpenCurlyDoubleQuote]interesting\
\[CloseCurlyDoubleQuote].\n",
 StyleBox["TODO: how to simplify this criterion",
  FontColor->RGBColor[
   0.6588235294117647, 0.592156862745098, 0.3254901960784314]]
}], "Text",
 CellChangeTimes->{{3.8804622917873454`*^9, 3.8804623130553675`*^9}, {
  3.880462388101943*^9, 3.8804624193451033`*^9}, {3.880462572023867*^9, 
  3.880462594274522*^9}},ExpressionUUID->"bae074a6-367a-4ff1-ab6f-\
bc9138276189"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"criterionAP", "[", "rule_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"Differences", "@", 
      RowBox[{"MinMax", "@", 
       RowBox[{"Flatten", "@", "\n", "       ", 
        RowBox[{"AnglePath", "[", 
         RowBox[{"2.", " ", 
          RowBox[{"\[Pi]", "/", "3"}], "  ", 
          RowBox[{"toBin", "@", 
           RowBox[{"First", "@", 
            RowBox[{"SubstitutionSystem", "[", 
             RowBox[{"rule", ",", " ", "\"\<A\>\"", ",", " ", 
              RowBox[{"{", "5", "}"}]}], "]"}]}]}]}], "]"}]}]}]}]}], " ", ">",
     " ", "3."}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.8804605489531727`*^9, {3.8804606025284386`*^9, 3.8804607037323775`*^9}, 
   3.8804607370336685`*^9, {3.880460858731903*^9, 3.8804608743166776`*^9}, {
   3.8804609500796776`*^9, 3.8804609614666777`*^9}, {3.880461011755073*^9, 
   3.880461014130862*^9}, {3.88046111150988*^9, 3.8804611305973177`*^9}, {
   3.8804611758006845`*^9, 3.8804611837084856`*^9}, {3.8804612329101295`*^9, 
   3.8804612950226135`*^9}, {3.8804613707111535`*^9, 
   3.8804614303480325`*^9}, {3.880461489854659*^9, 3.88046150782087*^9}, 
   3.880461645964527*^9, {3.8804617246284003`*^9, 3.8804617452246685`*^9}, {
   3.880462269690595*^9, 3.880462305792252*^9}, {3.880462597551593*^9, 
   3.880462600629917*^9}},ExpressionUUID->"923f69b2-4a26-4efb-88b7-\
9e019cee49e3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"result", "=", 
   RowBox[{"selectTuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rulesSet", "[", 
        RowBox[{"2", ",", "2"}], "]"}], ",", 
       RowBox[{"rulesSet", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"criterionAP", "[", "#", "]"}], "&"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.880461250511224*^9, 3.8804612576313543`*^9}, {
  3.880461445295474*^9, 3.88046145385012*^9}, {3.880462604589074*^9, 
  3.8804626046422462`*^9}},ExpressionUUID->"5c7bb96d-51aa-4bd2-aa82-\
57196616d85e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"showPath", "[", 
     RowBox[{
      RowBox[{"toBin", "@", "\[IndentingNewLine]", 
       RowBox[{"First", "@", 
        RowBox[{"SubstitutionSystem", "[", 
         RowBox[{
          RowBox[{
          "result", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", "\"\<A\>\"", ",", 
          RowBox[{"{", "n", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"2.", 
       RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "result"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "30", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.880460311384135*^9, 3.8804603116696873`*^9}, {
  3.88046034524749*^9, 3.880460370421007*^9}, {3.8804607445550385`*^9, 
  3.880460758692615*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"c6b2301a-effd-44e1-8cb5-7fb8e1016d96"]
}, Open  ]]
},
WindowSize->{949., 502.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"24f3c3c2-f255-4661-956c-0006488b1d57"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 222, 4, 67, "Section",ExpressionUUID->"0cf9f8fd-b73e-45db-9e33-c8d0c667e21a"],
Cell[CellGroupData[{
Cell[827, 30, 212, 4, 54, "Subsection",ExpressionUUID->"0a2f3d74-7f6b-41c8-9033-47fea6ceeb83"],
Cell[1042, 36, 575, 14, 166, "Text",ExpressionUUID->"f5d8d81d-42f1-4a19-9862-02d41ba11a86"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1666, 56, 149, 3, 67, "Section",ExpressionUUID->"b43e662b-d27f-4041-af33-a8ae60876f04"],
Cell[1818, 61, 1943, 42, 181, "Input",ExpressionUUID->"80d083a0-e9c6-4766-81c9-f9ea6a79205f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3798, 108, 184, 3, 67, "Section",ExpressionUUID->"489079a7-0c4a-4e41-830d-0a81c4705658"],
Cell[3985, 113, 772, 13, 144, "Text",ExpressionUUID->"31a0fbb4-587d-4fb8-a8c7-a928f75bdf48"],
Cell[4760, 128, 3930, 90, 242, "Input",ExpressionUUID->"0a1f761f-d887-47ca-9cc9-e8d496a9d445"],
Cell[8693, 220, 1207, 30, 107, "Input",ExpressionUUID->"a94a9448-330d-4ae4-bd86-de41f613d403"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9937, 255, 177, 3, 67, "Section",ExpressionUUID->"a3fbc1c4-f795-46a1-94b2-323517934d97"],
Cell[10117, 260, 1476, 30, 107, "Input",ExpressionUUID->"680fcf3e-0f02-44ed-8ec8-8bbb3b16141a"],
Cell[11596, 292, 1267, 19, 48, "Input",ExpressionUUID->"6cfdde91-76c9-4582-be90-3f639699ce41"],
Cell[12866, 313, 422, 12, 56, "Text",ExpressionUUID->"4ca806ce-ef16-407b-a60f-734b0678f084"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13325, 330, 213, 4, 67, "Section",ExpressionUUID->"039cf0c1-710f-4d8b-ae7f-de8b4e4d7253"],
Cell[13541, 336, 1933, 53, 103, "Input",ExpressionUUID->"51f47a97-3e9a-4601-bf9f-a72c5f4e4569",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[15499, 393, 206, 3, 54, "Subsection",ExpressionUUID->"0b1c75bb-719f-4a62-af47-6de5fef74574"],
Cell[15708, 398, 600, 15, 28, "Input",ExpressionUUID->"4f0c8e54-6a20-4390-a7f5-ac5b41d785a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16345, 418, 250, 4, 54, "Subsection",ExpressionUUID->"f976285d-3020-4d54-a481-c08135e83b67"],
Cell[16598, 424, 356, 8, 56, "Text",ExpressionUUID->"c968d682-4d95-4cab-b4f0-8e40dde370ad"],
Cell[16957, 434, 1243, 28, 64, "Input",ExpressionUUID->"3417715c-53a5-45ea-8305-27584ccef85d",
 InitializationCell->True],
Cell[18203, 464, 684, 16, 28, "Input",ExpressionUUID->"6ea12793-87cd-43b6-bb08-bf9591346b90"],
Cell[18890, 482, 612, 15, 68, "Input",ExpressionUUID->"682ff5df-e87b-44d9-a478-20d3e8299c1c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19551, 503, 232, 4, 67, "Section",ExpressionUUID->"e09bb414-1d56-4bf1-8297-356563607fba"],
Cell[19786, 509, 1372, 32, 64, "Input",ExpressionUUID->"05af96d2-455a-4ca8-8927-4b2062878d06",
 InitializationCell->True],
Cell[21161, 543, 745, 19, 64, "Input",ExpressionUUID->"6fddaba5-f45e-4560-97f4-77cee492bde5",
 InitializationCell->True],
Cell[21909, 564, 1188, 23, 126, "Input",ExpressionUUID->"8d7ebd0b-66c0-47b7-b8a0-d53d58b8620d"],
Cell[23100, 589, 571, 11, 78, "Text",ExpressionUUID->"bae074a6-367a-4ff1-ab6f-bc9138276189"],
Cell[23674, 602, 1417, 29, 68, "Code",ExpressionUUID->"923f69b2-4a26-4efb-88b7-9e019cee49e3"],
Cell[25094, 633, 633, 16, 48, "Input",ExpressionUUID->"5c7bb96d-51aa-4bd2-aa82-57196616d85e"],
Cell[25730, 651, 1068, 25, 126, "Input",ExpressionUUID->"c6b2301a-effd-44e1-8cb5-7fb8e1016d96"]
}, Open  ]]
}
]
*)

